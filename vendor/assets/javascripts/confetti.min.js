function draw(){ctx.clearRect(0,0,W,H);for(var a=0;a<mp;a++){var b=particles[a];ctx.beginPath(),ctx.lineWidth=b.r/2,ctx.strokeStyle=b.color,ctx.moveTo(b.x+b.tilt+b.r/4,b.y),ctx.lineTo(b.x+b.tilt,b.y+b.tilt+b.r/4),ctx.stroke()}update()}function draw2(){ctx.clearRect(0,0,W,H);for(var a=0;a<mp;a++){var b=particles[a];ctx.beginPath(),ctx.lineWidth=b.r/2,ctx.strokeStyle=b.color,ctx.moveTo(b.x+b.tilt+b.r/4,b.y),ctx.lineTo(b.x+b.tilt,b.y+b.tilt+b.r/4),ctx.stroke()}update2()}function randomFromTo(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function update(){angle+=.01,tiltAngle+=.1,TiltChangeCountdown--;for(var a=0;a<mp;a++){var b=particles[a];b.tiltAngle+=b.tiltAngleIncremental,b.y+=(Math.cos(angle+b.d)+1+b.r/2)/2,b.x+=Math.sin(angle),b.tilt=15*Math.sin(b.tiltAngle-a/3),(b.x>W+5||b.x<-5||b.y>H)&&(a%5>0||a%2==0?particles[a]={x:Math.random()*W,y:-10,r:b.r,d:b.d,color:b.color,tilt:Math.floor(10*Math.random())-10,tiltAngle:b.tiltAngle,tiltAngleIncremental:b.tiltAngleIncremental}:Math.sin(angle)>0?particles[a]={x:-5,y:Math.random()*H,r:b.r,d:b.d,color:b.color,tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:b.tiltAngleIncremental}:particles[a]={x:W+5,y:Math.random()*H,r:b.r,d:b.d,color:b.color,tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:b.tiltAngleIncremental})}}function update2(){angle+=.01,tiltAngle+=.1,TiltChangeCountdown--;for(var a=0;a<mp;a++){var b=particles[a];b.tiltAngle+=b.tiltAngleIncremental,b.y+=(Math.cos(angle+b.d)+1+b.r/2)/2,b.x+=Math.sin(angle),b.tilt=15*Math.sin(b.tiltAngle-a/3)}}function StartConfetti(){timer=!0,particles=[];for(var a=0;a<mp;a++)particles.push({x:1*W,y:1*H,r:randomFromTo(5,30),d:Math.random()*mp+10,color:"rgba("+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", 0.7)",tilt:Math.floor(10*Math.random())-10,tiltAngleIncremental:.07*Math.random()+.05,tiltAngle:0});W=$(document).width(),H=$(document).height(),canvas.width=W,canvas.height=H,clearTimeout(confettiHandler),confettiHandler=setInterval(draw,15)}function StopConfetti(){timer=!1,clearTimeout(confettiHandler),confettiHandler=setInterval(draw2,15)}var timer=!1,canvas,ctx,confettiHandler,W,H,mp=150,particles=[],TiltChangeCountdown=5,angle=0,tiltAngle=0;$(window).resize(function(){canvas=document.getElementById("canvas"),W=$(document).width(),H=$(document).height(),canvas.width=W,canvas.height=H}),$(document).ready(function(){canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),W=window.innerWidth,H=window.innerHeight,canvas.width=W,canvas.height=H,$(".box").hover(StartConfetti,StopConfetti),confetti_switch=0,$(".box").click(function(){1==confetti_switch?timer&&(StopConfetti(),$(".box").hover(StartConfetti,StopConfetti),confetti_switch=0):timer?(confetti_switch=1,$(".box").unbind("mouseenter").unbind("mouseleave")):StartConfetti()})});